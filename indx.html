<!DOCTYPE html>
<html lang="id">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>Predator Bumi - GALACTIC MAX</title>
Â  Â  <style>
Â  Â  Â  Â  .entry-max {
Â  Â  display: flex;
Â  Â  justify-content: space-between;
Â  Â  align-items: center;
Â  Â  padding: 12px 15px;
Â  Â  background: rgba(255, 255, 255, 0.03);
Â  Â  border-radius: 15px;
Â  Â  margin-bottom: 8px;
Â  Â  border: 1px solid rgba(0, 242, 255, 0.1);
Â  Â  transition: 0.3s;
}

.entry-max:hover {
Â  Â  background: rgba(0, 242, 255, 0.05);
Â  Â  border-color: var(--neon);
}

.planet-badge {
Â  Â  background: linear-gradient(135deg, #222, #000);
Â  Â  padding: 4px 10px;
Â  Â  border-radius: 10px;
Â  Â  border: 1px solid #444;
Â  Â  color: #fff;
Â  Â  font-size: 0.8rem;
Â  Â  font-weight: bold;
Â  Â  box-shadow: 0 0 10px rgba(0,0,0,0.5);
}
Â  Â  Â  Â Â 
Â  Â  Â  Â  :root { --primary: #ff0033; --accent: #ffd700; --neon: #00f2ff; --glass: rgba(0, 0, 0, 0.8); }
Â  Â  Â  Â  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

Â  Â  Â  Â  /* --- BACKGROUND ANIMASI BERAT (MAX ONLY) --- */
Â  Â  Â  Â  body {Â 
Â  Â  Â  Â  Â  Â  margin: 0; background: #000; color: #fff;
Â  Â  Â  Â  Â  Â  font-family: 'Orbitron', 'Segoe UI', sans-serif;Â 
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow-x: hidden;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .space-bg {
Â  Â  Â  Â  Â  Â  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
Â  Â  Â  Â  Â  Â  z-index: -1; overflow: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Bintang Bergerak */
Â  Â  Â  Â  .stars {
Â  Â  Â  Â  Â  Â  position: absolute; width: 2px; height: 2px; background: white;
Â  Â  Â  Â  Â  Â  opacity: 0.5; box-shadow: 0 0 10px white;
Â  Â  Â  Â  Â  Â  animation: moveStars 20s linear infinite;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes moveStars {
Â  Â  Â  Â  Â  Â  from { transform: translateY(0); }
Â  Â  Â  Â  Â  Â  to { transform: translateY(-2000px); }
Â  Â  Â  Â  }

Â  Â  Â  Â  .container { width: 100%; max-width: 420px; padding: 25px; z-index: 2; }

Â  Â  Â  Â  /* --- UI WOW: NEON GLASS --- */
Â  Â  Â  Â  .stats-box, .action-card, .leaderboard, .chat-room {Â 
Â  Â  Â  Â  Â  Â  background: var(--glass); border: 1px solid rgba(0, 242, 255, 0.3);
Â  Â  Â  Â  Â  Â  border-radius: 25px; padding: 20px; margin-bottom: 25px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 15px rgba(0, 242, 255, 0.1); backdrop-filter: blur(20px);
Â  Â  Â  Â  }

Â  Â  Â  Â  #population {Â 
Â  Â  Â  Â  Â  Â  color: var(--primary); font-weight: 900; font-size: 2.8rem;Â 
Â  Â  Â  Â  Â  Â  text-align: center; display: block;Â 
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 20px #ff0033, 0 0 40px #660000;
Â  Â  Â  Â  Â  Â  letter-spacing: -2px; margin: 15px 0;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- BUTTON PREMIUM --- */
Â  Â  Â  Â  .btn-main {Â 
Â  Â  Â  Â  Â  Â  width: 100%; padding: 50px 10px; font-size: 2.5rem; font-weight: 900; color: #fff;Â 
Â  Â  Â  Â  Â  Â  background: linear-gradient(45deg, #ff0033, #660000);Â 
Â  Â  Â  Â  Â  Â  border: 2px solid rgba(255,255,255,0.3); border-radius: 30px;
Â  Â  Â  Â  Â  Â  cursor: pointer; position: relative; overflow: hidden;
Â  Â  Â  Â  Â  Â  box-shadow: 0 10px 30px rgba(255,0,51,0.4);
Â  Â  Â  Â  Â  Â  transition: 0.2s; text-transform: uppercase;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-main::after {
Â  Â  Â  Â  Â  Â  content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
Â  Â  Â  Â  Â  Â  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
Â  Â  Â  Â  Â  Â  transform: rotate(45deg); animation: shimmer 3s infinite;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes shimmer { 0% { left: -100%; } 100% { left: 100%; } }
Â  Â  Â  Â  .btn-main:active { transform: scale(0.92); box-shadow: 0 5px 15px #ff0033; }

Â  Â  Â  Â  .btn-up {Â 
Â  Â  Â  Â  Â  Â  width: 100%; padding: 16px; margin-top: 12px; background: rgba(0, 242, 255, 0.05);Â 
Â  Â  Â  Â  Â  Â  color: var(--neon); border: 1px solid var(--neon); border-radius: 15px;Â 
Â  Â  Â  Â  Â  Â  font-weight: bold; cursor: pointer; transition: 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-up:hover { background: rgba(0, 242, 255, 0.2); }
Â  Â  Â  Â  .btn-up:disabled { opacity: 0.2; border-color: #444; color: #444; }

Â  Â  Â  Â  /* FRENZY ALERT */
Â  Â  Â  Â  #frenzyBox {
Â  Â  Â  Â  Â  Â  display: none; background: linear-gradient(90deg, #ffd700, #ff0033);
Â  Â  Â  Â  Â  Â  color: #000; font-weight: 900; padding: 10px; border-radius: 15px;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px; text-align: center; animation: pulse 0.5s infinite;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

Â  Â  Â  Â  /* CHAT ROOM WHITE MAX */
Â  Â  Â  Â  .chat-room { background: rgba(255, 255, 255, 0.95); color: #000; border: none; }
Â  Â  Â  Â  .chat-box { height: 150px; overflow-y: auto; font-family: sans-serif; }
Â  Â  Â  Â  .chat-msg { background: #eee; padding: 8px 12px; border-radius: 15px; margin-bottom: 6px; font-size: 0.85rem; border-left: 5px solid var(--primary); }

Â  Â  Â  Â  /* LEADERBOARD GOLD */
Â  Â  Â  Â  .rank-gold {
Â  Â  Â  Â  Â  Â  background: linear-gradient(90deg, #ffd700, #fff, #ffd700, #fff); background-size: 200%;
Â  Â  Â  Â  Â  Â  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
Â  Â  Â  Â  Â  Â  font-weight: 900; animation: goldMove 2s infinite linear;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes goldMove { to { background-position: 200%; } }

Â  Â  Â  Â  .hp-container { width: 100%; background: #222; height: 10px; border-radius: 5px; margin: 15px 0; overflow: hidden; border: 1px solid #444; }
Â  Â  Â  Â  #hpBar { width: 100%; height: 100%; background: linear-gradient(90deg, #ff0033, #00f2ff); transition: width 0.3s cubic-bezier(0.17, 0.67, 0.83, 0.67); }

Â  Â  Â  Â  .particle { position: absolute; pointer-events: none; border-radius: 50%; z-index: 10; animation: explode 0.8s ease-out forwards; }
Â  Â  Â  Â  @keyframes explode { 0% { transform: translate(0,0) scale(1); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; } }
Â  Â  Â  Â  .floating-damage {
Â  Â  position: absolute;
Â  Â  pointer-events: none;
Â  Â  font-weight: 900;
Â  Â  font-size: 1.5rem;
Â  Â  font-family: 'Orbitron', sans-serif;
Â  Â  z-index: 1000;
Â  Â  animation: floatCritical 0.7s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards;
Â  Â  text-shadow: 0 0 10px currentColor, 0 0 20px currentColor;
}

@keyframes floatCritical {
Â  Â  0% { transform: scale(0.5) translateY(0); opacity: 1; }
Â  Â  50% { transform: scale(1.2) translateY(-50px); opacity: 1; }
Â  Â  100% { transform: scale(1) translateY(-120px); opacity: 0; }
}

/* Tambahan agar font Orbitron masuk */
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap');

Â  Â  </style>
</head>
<body>

<div class="space-bg" id="space"></div>

<div class="container">
Â  Â  <div id="frenzyBox">â˜¢ï¸ FRENZY MODE: 2X CRITICAL DAMAGE â˜¢ï¸</div>

Â  Â  <div style="font-size: 0.75rem; color: var(--neon); display: flex; justify-content: space-between; margin-bottom: 15px; text-shadow: 0 0 5px var(--neon);">
Â  Â  Â  Â  <span>PREDATOR: <b id="pId">---</b></span>
Â  Â  Â  Â  <span id="connState">SINKRONISASI...</span>
Â  Â  </div>

Â  Â  <div class="stats-box" id="planetBox">
Â  Â  Â  Â  <small style="color:#888; letter-spacing: 3px; font-size: 0.6rem;">PLANETARY POPULATION</small>
Â  Â  Â  Â  <span id="population">8.000.000.000</span>
Â  Â  Â  Â  <div class="hp-container"><div id="hpBar"></div></div>
Â  Â  Â  Â  <div style="font-size: 0.85rem; display: flex; justify-content: space-between; font-weight: bold;">
Â  Â  Â  Â  Â  Â  <span>ğŸ’° <b id="money" style="color:var(--accent)">0</b></span>
Â  Â  Â  Â  Â  Â  <span>ğŸ¯ <b id="clickTask" style="color:var(--neon)">0</b>/10k</span>
Â  Â  Â  Â  Â  Â  <span>ğŸŒ <b id="planet">0</b></span>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <button class="btn-main" id="biteBtn">DESTROY!</button>


Â  Â  <div class="action-card">
Â  Â  Â  Â  <button class="btn-up" id="upGigi">ğŸ§¬ MUTASI GIGI (+1) | ğŸ’° <span id="gCost">15</span></button>
Â  Â  Â  Â  <button class="btn-up" id="upVirus">ğŸ¦  VIRUS GALAXY (-2/s) | ğŸ’° <span id="vCost">50</span></button>
Â  Â  Â  Â  <button class="btn-up" onclick="transferKoin()" style="border-color: #ffd700; color: #ffd700;">ğŸ’ TRANSFER ASSET</button>
Â  Â  <a href="indx.html" target="_blank" style="text-decoration: none;">
Â  Â  Â  Â  <button class="btn-up" style="background: linear-gradient(90deg, #1e3c72, #2a5298); border-color: #00d2ff; color: #fff; margin-top: 15px;">
Â  Â  Â  Â  Â  Â  ğŸ¥”
Â  Â  Â  Â  </button>
Â  Â  </a>
Â  Â  </div>

Â  Â  <div class="chat-room">
Â  Â  Â  Â  <div id="chatBox" class="chat-box">Connecting to GalaxNet...</div>
Â  Â  Â  Â  <div style="display:flex; gap:8px; margin-top: 10px;">
Â  Â  Â  Â  Â  Â  <input type="text" id="chatInput" style="flex:1; padding:12px; border-radius:12px; border:1px solid #ddd;" placeholder="Pesan Antar Bintang..." maxlength="30">
Â  Â  Â  Â  Â  Â  <button id="sendChat" style="background:var(--primary); color:#fff; border:none; padding:10px 15px; border-radius:12px; font-weight:900;">></button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="leaderboard">
Â  Â  Â  Â  <h3 style="margin:0 0 15px 0; font-size:1.1rem; color:var(--neon); text-align:center; text-shadow: 0 0 10px var(--neon);">ğŸ† SUPREME PREDATORS</h3>
Â  Â  Â  Â  <div id="rankList"></div>
Â  Â  Â  Â  <div id="extraList" style="display:none;"></div>
Â  Â  Â  Â  <button id="btnToggle" onclick="window.toggleRanks()" style="width:100%; background:none; border:none; color:#555; cursor:pointer; margin-top:15px; font-weight: bold;">[ LIHAT RANKING LAINNYA ]</button>
Â  Â  </div>
</div>

<script type="module">
Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
Â  Â  import { getFirestore, doc, getDoc, setDoc, collection, query, orderBy, limit, onSnapshot, updateDoc, addDoc, serverTimestamp, where } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

Â  Â  const firebaseConfig = {
Â  Â  Â  Â  apiKey: "AIzaSyD3tna4rUSr_FH0eb08aI3AX3Z-fVcqaj8",
Â  Â  Â  Â  authDomain: "fruitsmasmaster.firebaseapp.com",
Â  Â  Â  Â  projectId: "fruitsmasmaster",
Â  Â  Â  Â  storageBucket: "fruitsmasmaster.firebasestorage.app",
Â  Â  Â  Â  messagingSenderId: "673530855742",
Â  Â  Â  Â  appId: "1:673530855742:web:ac1395bda6c68f764cac6f"
Â  Â  };

Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  const db = getFirestore(app);

Â  Â  const sfxBite = new Audio('https://assets.mixkit.co/active_storage/sfx/2296/2296-preview.mp3');
Â  Â  const sfxExplode = new Audio('https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3');

Â  Â  let id = localStorage.getItem('solo_uid');
Â  Â  let data = { population: 8000000000, consumed: 0, clickPower: 1, clickCost: 15, afkPower: 0, afkCost: 50, planetsCleared: 0, manualClicks: 0, frenzyUntil: 0, lastActive: Date.now() };
Â  Â  const MAX_POP = 8000000000;
Â  Â  let isTransitioning = false;

Â  Â  async function init() {
Â  Â  Â  Â  if(!id) {
Â  Â  Â  Â  Â  Â  let n = prompt("DAFTARKAN KODE PREDATOR (ID):");
Â  Â  Â  Â  Â  Â  if(!n || n.length < 3) return init();
Â  Â  Â  Â  Â  Â  id = n.toUpperCase().replace(/\s/g, "_");
Â  Â  Â  Â  Â  Â  localStorage.setItem('solo_uid', id);
Â  Â  Â  Â  Â  Â  await setDoc(doc(db, "players", id), data);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('pId').innerText = id;
Â  Â  Â  Â  const snap = await getDoc(doc(db, "players", id));
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(snap.exists()) {
Â  Â  Â  Â  Â  Â  const dbData = snap.data();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // --- LOGIKA AFK OFFLINE ---
Â  Â  Â  Â  Â  Â  if (dbData.lastActive && dbData.afkPower > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  const sekarang = Date.now();
Â  Â  Â  Â  Â  Â  Â  Â  const selisihDetik = Math.floor((sekarang - dbData.lastActive) / 1000);
Â  Â  Â  Â  Â  Â  Â  Â  const waktuDihitung = Math.min(selisihDetik, 86400); // Max 24 jam
Â  Â  Â  Â  Â  Â  Â  Â  const koinDihasilkan = waktuDihitung * dbData.afkPower;

Â  Â  Â  Â  Â  Â  Â  Â  if (koinDihasilkan > 10) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dbData.consumed = (dbData.consumed || 0) + koinDihasilkan;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dbData.population = (dbData.population || MAX_POP) - koinDihasilkan;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert(`ğŸš€ WELCOME BACK!\nVirus kamu dapet: ğŸ’° ${Math.floor(koinDihasilkan).toLocaleString()} koin saat kamu offline!`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  data = { ...data, ...dbData };
Â  Â  Â  Â  }

Â  Â  Â  Â  initChat();Â 
Â  Â  Â  Â  initRank();Â 
Â  Â  Â  Â  updateUI();

Â  Â  Â  Â  // Jalanin virus tiap detik
Â  Â  Â  Â  setInterval(() => {Â 
Â  Â  Â  Â  Â  Â  if(data.afkPower > 0) processHit(data.afkPower, false);Â 
Â  Â  Â  Â  Â  Â  updateUI();Â 
Â  Â  Â  Â  }, 1000);

Â  Â  Â  Â  // PENTING: Simpan data tiap 15 detik agar waktu offline tercatat
Â  Â  Â  Â  setInterval(save, 15000);
Â  Â  }

Â  Â  const save = async () => {Â 
Â  Â  if(id && !isTransitioning) {Â 
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const playerRef = doc(db, "players", id);
Â  Â  Â  Â  Â  Â  await updateDoc(playerRef, {Â 
Â  Â  Â  Â  Â  Â  Â  Â  ...data,Â 
Â  Â  Â  Â  Â  Â  Â  Â  lastActive: Date.now()Â 
Â  Â  Â  Â  Â  Â  });Â 
Â  Â  Â  Â  Â  Â  console.log("âœ… Auto-save Berhasil: Waktu Aktif Diperbarui!");
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  console.error("âŒ Gagal save:", e);
Â  Â  Â  Â  }
Â  Â  }Â 
};


Â  Â  function processHit(amt, isManual) {
Â  Â  Â  Â  if(isTransitioning) return;
Â  Â  Â  Â  let power = amt;
Â  Â  Â  Â  if(isManual && Date.now() < data.frenzyUntil) power *= 2;
Â  Â  Â  Â  data.population -= power; data.consumed += power;
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(isManual) {
Â  Â  Â  Â  Â  Â  data.manualClicks++;
Â  Â  Â  Â  Â  Â  if(data.manualClicks >= 10000) { data.manualClicks = 0; data.frenzyUntil = Date.now() + 20000; }
Â  Â  Â  Â  }

Â  Â  Â  Â  if(data.population <= 0) {
Â  Â  Â  Â  Â  Â  isTransitioning = true; data.population = 0;
Â  Â  Â  Â  Â  Â  sfxExplode.play();
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  data.planetsCleared++;Â 
Â  Â  Â  Â  Â  Â  Â  Â  data.population = MAX_POP;
Â  Â  Â  Â  Â  Â  Â  Â  isTransitioning = false;Â 
Â  Â  Â  Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  Â  Â  Â  Â  save();
Â  Â  Â  Â  Â  Â  }, 800);
Â  Â  Â  Â  }
Â  Â  Â  Â  return power;
Â  Â  }

Â  Â  document.getElementById('biteBtn').onclick = (e) => {
Â  Â  Â  Â  sfxBite.currentTime = 0; sfxBite.play();
Â  Â  Â  Â  const p = processHit(data.clickPower, true);
Â  Â  Â  Â  const d = document.createElement('div');
Â  Â  Â  Â  d.className = 'floating-damage';
Â  Â  Â  Â  d.innerText = `-${Math.floor(p)}`;
Â  Â  Â  Â  d.style.left = e.clientX + 'px'; d.style.top = e.clientY + 'px';
Â  Â  Â  Â  document.body.appendChild(d);
Â  Â  Â  Â  setTimeout(() => d.remove(), 700);
Â  Â  Â  Â  updateUI();
Â  Â  };

Â  Â  document.getElementById('upGigi').onclick = () => {
Â  Â  Â  Â  if(data.consumed >= data.clickCost) {
Â  Â  Â  Â  Â  Â  data.consumed -= data.clickCost;
Â  Â  Â  Â  Â  Â  data.clickPower += 1;
Â  Â  Â  Â  Â  Â  data.clickCost = Math.floor(data.clickCost * 1.5);
Â  Â  Â  Â  Â  Â  updateUI(); save();
Â  Â  Â  Â  }
Â  Â  };

Â  Â  document.getElementById('upVirus').onclick = () => {
Â  Â  Â  Â  if(data.consumed >= data.afkCost) {
Â  Â  Â  Â  Â  Â  data.consumed -= data.afkCost;
Â  Â  Â  Â  Â  Â  data.afkPower += 2;
Â  Â  Â  Â  Â  Â  data.afkCost = Math.floor(data.afkCost * 1.6);
Â  Â  Â  Â  Â  Â  updateUI(); save();
Â  Â  Â  Â  }
Â  Â  };

Â  Â  function updateUI() {
Â  Â  Â  Â  document.getElementById('population').innerText = Math.max(0, Math.floor(data.population)).toLocaleString('id-ID');
Â  Â  Â  Â  document.getElementById('money').innerText = Math.floor(data.consumed).toLocaleString();
Â  Â  Â  Â  document.getElementById('planet').innerText = data.planetsCleared;
Â  Â  Â  Â  document.getElementById('clickTask').innerText = data.manualClicks;
Â  Â  Â  Â  document.getElementById('gCost').innerText = data.clickCost.toLocaleString();
Â  Â  Â  Â  document.getElementById('vCost').innerText = data.afkCost.toLocaleString();
Â  Â  Â  Â  document.getElementById('hpBar').style.width = (data.population/MAX_POP*100) + "%";
Â  Â  Â  Â  document.getElementById('upGigi').disabled = data.consumed < data.clickCost;
Â  Â  Â  Â  document.getElementById('upVirus').disabled = data.consumed < data.afkCost;
Â  Â  }

Â  Â  function initChat() {
Â  Â  Â  Â  onSnapshot(query(collection(db, "messages"), orderBy("createdAt", "desc"), limit(15)), (s) => {
Â  Â  Â  Â  Â  Â  let h = ""; s.docs.reverse().forEach(d => {
Â  Â  Â  Â  Â  Â  Â  Â  h += `<div class="chat-msg"><b>${d.data().sender}:</b> ${d.data().text}</div>`;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  document.getElementById('chatBox').innerHTML = h;
Â  Â  Â  Â  Â  Â  document.getElementById('chatBox').scrollTop = 999;
Â  Â  Â  Â  });
Â  Â  }

Â  Â  document.getElementById('sendChat').onclick = async () => {
Â  Â  Â  Â  const i = document.getElementById('chatInput');
Â  Â  Â  Â  if(i.value.trim()) {
Â  Â  Â  Â  Â  Â  await addDoc(collection(db, "messages"), { sender: id, text: i.value, createdAt: serverTimestamp() });
Â  Â  Â  Â  Â  Â  i.value = "";
Â  Â  Â  Â  }
Â  Â  };

Â  Â  function initRank() {
Â  Â  Â  Â  onSnapshot(query(collection(db, "players"), orderBy("consumed", "desc"), limit(20)), (snap) => {
Â  Â  Â  Â  Â  Â  let h1 = ""; let count = 0; const now = Date.now();
Â  Â  Â  Â  Â  Â  snap.forEach(d => {
Â  Â  Â  Â  Â  Â  Â  Â  count++; const p = d.data();
Â  Â  Â  Â  Â  Â  Â  Â  const isOn = p.lastActive && (now - p.lastActive) < 60000;
Â  Â  Â  Â  Â  Â  Â  Â  h1 += `<div class="entry-max">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; align-items:center; gap:10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="width:8px; height:8px; background:${isOn?'#0f0':'#444'}; border-radius:50%;"></span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><b>${count}. ${d.id}</b><br><small>ğŸ’° ${Math.floor(p.consumed).toLocaleString()}</small></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="planet-badge">ğŸŒ ${p.planetsCleared || 0}</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  document.getElementById('rankList').innerHTML = h1;
Â  Â  Â  Â  });
Â  Â  }

Â  Â  init();

</script>
</body>
</html>
